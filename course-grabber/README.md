# Course Grabber

大學選課系統自動化腳本 - 精確時間控制 + 競爭處理機制。

**技術棧**: Python, Selenium WebDriver, Firefox

## 學習歷程紀錄

這是大學時期（2022-2023）的作品，保留於此展示技術成長軌跡。當時的代碼品質尚有改進空間（硬編碼選擇器、缺少類型標註），但核心設計思路是正確的，實際使用時也成功搶到了熱門課程。

## 為什麼做這個專案

大學選課系統開放時，熱門課程會在幾秒內額滿。手動搶課的問題：

- 反應速度不夠快
- 需要提前登入但不能太早（會被自動登出）
- 必須精確在整點開始時搶課

所以我做了這個自動化腳本。

## 核心設計

### 三階段精確時間控制

```text
T-5 分鐘 → 登入系統
T-1 分鐘 → 進入選課頁面
T-1 秒   → 開始瞬間點擊
```

**為什麼這樣設計**：

- T-5 分鐘：避免過早登入被自動登出
- T-1 分鐘：確保已經在選課頁面，減少網路延遲
- T-1 秒：補償反應時間和網路延遲

### 競爭處理機制

```python
# 第一志願：重複點擊直到成功
while True:
    driver.find_element(By.XPATH, start_add_btn + '2' + end_add_btn).click()
    alert_accept()
    if grab_success in alert_text:
        break
```

**為什麼需要這個**：因為其他同學也在搶，可能第一次點擊時還沒輪到自己。持續點擊直到成功。

### 測試模式

執行前先跑一遍完整流程（登入 → 點擊 → Alert 處理），確保腳本能正常運作。避免實際搶課時才發現問題。

## 代碼品質問題

這是我學習程式設計早期的作品，有很多問題：

**1. 硬編碼 XPath**：網頁改版會失效

```python
start_add_btn = '//*[@id="ContentPlaceHolder1_grd_subjs"]/tbody/tr['
```

**2. 全域變數**：`driver` 和 `alert_text` 存在全域

```python
global driver, alert_text
```

**3. 裸 except**：沒有指定例外類型

```python
except:
    break
```

## 如果現在重寫

會採用：

- **更現代的框架**：Playwright 而非 Selenium（反偵測更好）
- **配置檔案**：YAML 存放設定，不要硬編碼
- **更健壯的選擇器**：CSS selector 或 data-testid
- **類型標註**：用 type hints
- **結構化日誌**：logging 模組而非 print

但當時的思維邏輯是正確的：

- ✅ 問題分析：理解選課系統的時間限制和競爭本質
- ✅ 邏輯設計：三階段時間控制、測試模式、錯誤處理
- ❌ 代碼品質：缺少現代 Python 實踐

## 反思

保留這個專案是為了展示完整的學習軌跡，而不是隱藏早期的不足。

**這個專案展示了**：

- 即使代碼不完美，只要邏輯正確，就能解決問題
- 技術會進步，但問題分析能力更重要
- 誠實面對自己的成長過程

## 代碼文件

- [grabber.py](./grabber.py) - 選課自動化腳本
